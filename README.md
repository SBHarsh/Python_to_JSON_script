# 🧠 Dynamic Painless Script Generator

This project automates the generation of **Elasticsearch Painless scripts** by reading **rule definitions from Excel**.  
It dynamically constructs complex aggregation logic (`scripted_metric`) for **Numerator** and **Denominator** calculations — saving hours of manual effort and ensuring consistency across multiple rule sets.

---

## 🚀 Features

- ✅ Reads business rules from an Excel file (`rules.xlsx`)
- ⚙️ Automatically parses rules (e.g., *Filter*, *Exclude*, *Unfilter*, *Contain*, etc.)
- 🔄 Dynamically generates a valid **Elasticsearch aggregation JSON**
- 📄 Outputs a clean, production-ready `generated_painless.json` file
- 🧩 Easily adaptable to any metric or rule definition

---

## 📂 Project Structure

📁 Dynamic_Painless_Script_Generator/
├── main.py # Main Python script
├── rules.xlsx # Input Excel containing Numerator/Denominator rules
├── generated_painless.json # Output JSON generated by the script
└── README.md # Project documentation


---

## 📘 How It Works

1. **Define your rules in Excel** like this:

| A (Column 0) | B (Column 1) |
|---------------|--------------|
| Numerator | 1. Exclude line where column "A (ColA Name)" = "val1"<br>2. Filter column "B (ColB Name)" contain "val2"<br>3. Filter column "D (ColD Name)" to "val3"<br>4. Filter column "C (ColC Name)" to "val4"<br>5. Unfilter column "K (ColK Name)" to "val5"<br>6. Get sum of column "L (ColL Name)"<br>7. Get Average of column "J (ColJ Name)"<br>8. Numerator = (sum of column "L (ColL Name)" * Average of column "J (ColJ Name)"/100) |
| Denominator | 1. Exclude line where column "A (ColA Name)" = "val1"<br>2. Filter column "B (ColB Name)" contain "val2"<br>3. Filter column "D (ColD Name)" to "val3"<br>4. Filter column "C (ColC Name)" to "val4"<br>5. Unfilter column "K (ColK Name)" to "val5"<br>6. Get sum of column "L (ColL Name)" |

2. **Run the Python script**.  
   It will:
   - Read your Excel file  
   - Parse the rules  
   - Build equivalent Painless logic  
   - Generate an Elasticsearch-ready JSON file

3. **Output file** (`generated_painless.json`) contains your scripted metric ready for ingestion.

---

## ⚙️ Setup & Usage

### 🔧 Requirements
- Python 3.8 or above  
- Required libraries:
  ```bash
  pip install pandas openpyxl
▶️ Run the Script

Place your rule definitions in rules.xlsx

Update the input/output paths in main.py

Run:  
python main.py
Output:
✅ Dynamic painless JSON generated successfully → generated_painless.json
